@using TempLoggerService.Models
<div id="body">
    <section class="featured">
        <div class="content-wrapper">
            <hgroup class="title">
                <h1>Welcome to TempLogger!</h1>
                <h2></h2>
            </hgroup>
            <p></p>
            <p></p>
        </div>
    </section>
    <section class="content-wrapper main-content clear-fix">
        Current temperature: <span id="currenttemp"></span><br />
        <canvas id="myChart" width="800" height="400"></canvas>
        <script type="text/javascript">
            var ctx = document.getElementById("myChart").getContext("2d");
            var chartdata = { labels: [], datasets: [{
                    label: "My First dataset",
                    fillColor: "rgba(220,220,220,0.2)",
                    strokeColor: "rgba(220,220,220,1)",
                    pointColor: "rgba(220,220,220,1)",
                    pointStrokeColor: "#fff",
                    pointHighlightFill: "#fff",
                    pointHighlightStroke: "rgba(220,220,220,1)",
                    data: []
                }]
            };

            $.getJSON("api/device/rpi2", function(data) {
                $.getJSON("api/temperature/GetLast24HourTemps/" + data, function(tempdata) {
                    for (var i = 0; i < tempdata.length; i++) {
                        chartdata.labels.push(tempdata[i].hour);
                        chartdata.datasets[0].data.push(tempdata[i].avgtemp);
                    }

                    var myLineChart = new Chart(ctx).Line(chartdata, { bezierCurve: false });
                });

                $.getJSON("api/temperature/GetLatestTemp/" + data, function(latesttemp) {
                    $("#currenttemp").html(latesttemp.temp + " @@ " + latesttemp.timestamp);
                });
            });
        </script>
    </section>
</div>
